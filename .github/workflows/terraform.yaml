# name: Terraform Infra
# on:
#   push:
#     branches: [main]
#   pull_request:
#     branches: [main]

# permissions:
#   id-token: write
#   contents: read

# jobs:
#   terraform:
#     runs-on: ubuntu-latest
#     strategy:
#       matrix:
#         component: [networking]
#     steps:
#       - uses: actions/checkout@v4

#       - name: Azure Login via OIDC
#         uses: azure/login@v2
#         with:
#           client-id: ${{ secrets.ARM_CLIENT_ID }}
#           tenant-id: ${{ secrets.ARM_TENANT_ID }}
#           subscription-id: ${{ secrets.ARM_SUBSCRIPTION_ID }}

#       - uses: hashicorp/setup-terraform@v3
#         with:
#           terraform_version: 1.9.0

#       - name: Terraform Init
#         working-directory: infra/terraform/${{ matrix.component }}
#         run: terraform init

#       - name: Plan
#         if: github.event_name == 'pull_request'
#         working-directory: infra/terraform/${{ matrix.component }}
#         run: terraform plan -no-color

#       - name: Apply
#         if: github.ref == 'refs/heads/main'
#         working-directory: infra/terraform/${{ matrix.component }}
#         run: terraform apply -auto-approve
